import{c as e,m as t,y as a,z as n,h as r,t as o,i,o as s,ae as u,P as l,af as c,ag as f,ah as d,Z as m,H as h,ai as p,B as b,aj as g,ak as v,al as y,D as w,am as k,an as C,ao as L,ap as D,f as M,aq as A,ar as V,as as S,at as H,A as B,au as N,a2 as G,T as x,v as T,ab as E,a3 as j,av as P,aw as F,O,u as R,C as I,ax as _,ay as q,az as Y,aA as z,aB as K,q as U,a as W,J as Q,aC as J,aD as Z,aE as X,aF as ee,aG as te,aH as ae,l as ne,V as re,M as oe,aI as ie,a7 as se,aJ as ue,aK as le,aL as ce,aM as fe,aN as de,aO as me,aP as he}from"./calfSystem-54df10e3.js"
import{n as pe}from"./numberIsNaN-fa7d637d.js"
import{r as be}from"./round-6850c0fc.js"
import{r as ge}from"./roundToString-16988956.js"
import{p as ve}from"./playerName-8f1e4e48.js"
import{c as ye}from"./createInput-0ba53f77.js"
import{i as we}from"./insertTextBeforeEnd-9513e143.js"
import"./testRange-e43cb031.js"
import{t as ke}from"./testQuant-8065b1d8.js"
import{a as Ce}from"./addCommas-508f0c08.js"
import{c as Le}from"./createLabel-eb1c6e94.js"
import{i as De}from"./insertElementBefore-1b96a575.js"
import{c as Me}from"./createStyle-864ea0ea.js"
import"./currentGuildId-7eae4191.js"
import"./intValue-e8157483.js"
import{v as Ae}from"./valueText-90531bb6.js"
import"./fshOpen-3e1a5fea.js"
import{o as Ve}from"./openQuickBuffByName-437ea92a.js"
import"./createUl-1f6da03c.js"
import{g as Se,s as He}from"./idb-7f0d2b39.js"
import"./isChecked-6167b36b.js"
import{b as Be}from"./simpleCheckbox-4ba02dd9.js"
import{c as $e}from"./createTable-a5bfc655.js"
import{p as Ne}from"./padZ-bd3dfcf9.js"
import{c as Ge}from"./createButton-077faa0f.js"
import"./createLi-679bc3b4.js"
import{c as xe}from"./createSpan-f01d3abc.js"
import{h as Te}from"./hideElement-f7381055.js"
import{e as Ee}from"./executeAll-be2ac0ec.js"
import"./chunk-c85463de.js"
import"./indexAjaxJson-9f23f983.js"
import"./cmdExport-064541e3.js"
import"./csvSplit-1d6bbc93.js"
import{s as je}from"./shouldBeArray-c3a8d09e.js"
import{g as Pe}from"./getArrayByClassName-1306b7b7.js"
import{t as Fe}from"./toggleForce-c034bc71.js"
import{a as Oe}from"./all-36f83e81.js"
import{e as Re}from"./eventHandler5-aae05673.js"
import{h as Ie}from"./hasClasses-c88c1c7c.js"
import{i as _e}from"./insertElementAfter-bb4c0be1.js"
import{g as qe}from"./getProfile-7795dbc9.js"
import{m as Ye}from"./myStats-e2765689.js"
import{g as ze}from"./guild-bcc0307e.js"
import{a as Ke}from"./allthen-7d061027.js"
import"./isSelected-9a0f1276.js"
import{r as Ue}from"./rnd-309b2e54.js"
import{g as We}from"./getMembrList-c71eddc1.js"
import{d as Qe,g as Je}from"./getGroupStats-c532ef16.js"
import"./groupViewStats-41b449bf.js"
import{g as Ze}from"./getMercStats-bad761d4.js"
import{b as Xe}from"./bitwiseAnd-af4dee83.js"
import{r as et}from"./reduceBuffArray-77073669.js"
import{g as tt,a as at}from"./getTitanString-6b80cb43.js"
import{d as nt,q as rt}from"./quickbuffSuccess-fef1e4d6.js"
import{a as ot}from"./huntingBuffs-1b84904d.js"
let it,st,ut,lt,ct,ft,dt,mt,ht
function pt(e){return e}function bt(n){if(function(t){return e.showBuffInfo&&t.some(pt)}(n))return function(){if(it)Fe(it,!1)
else{it=t({className:"fshActionBox",innerHTML:"<div></div><div></div><div></div><div></div><div></div><div></div>"})
const e=a("actionContainer")
_e(it,e.children[2])}return it}()
it&&Fe(it,!0)}function gt(e,t){st?Fe(st,!1):function(e){st=e.children[3],st.className="fshBlue",n("CA ",st),ut=xe(),r(st,ut),we(st," active")}(e),n(t.level,ut)}function vt(e,t){t?gt(e,t):st&&Fe(st,!0)}function yt(e,t){lt?Fe(lt,!1):function(e){lt=e.children[4],lt.className="fshRed",n("Doubler ",lt),ct=xe(),r(lt,ct),we(lt," active")}(e),n(t.level,ct)}function wt(e,t){t?yt(e,t):lt&&Fe(lt,!0)}function kt(e,t,a){ft?Fe(ft,!1):function(e){ft=e.children[2],n("Damage bonus: ",ft),dt=xe(),r(ft,dt),we(ft,"%")}(e),n(function(e,t){if(e){const a=Math.min(.01*Math.round(Math.floor(t/5)*Number(e.level)),20)
return be(a,2).toString()}return"0"}(t,Number(a)),dt)}function Ct(e,t,a){t?kt(e,t,a):ft&&Fe(ft,!0)}function Lt(e,t){n(Ce(e),t)}function Dt(e,t){mt?Fe(mt,!1):function(e){mt=e.children[1],n("Kill Streak: ",mt),ht=xe(),r(mt,ht)}(e),Lt(t,ht)}function Mt(e,t,a,n){t||a?Dt(e,n):mt&&Fe(mt,!0)}function At(e,t){return t.name===e}function Vt(e){const{buffs:t}=GameData.player()
if(t)return t.find(o(At,e))}const St=["red","orange","yellow"]
let Ht,Bt
function $t(e){rt(e)&&GameData.fetch(u)}function Nt(){Vt("Summon Shield Imp")||nt([ve()],[55]).then($t)}const Gt=["imp-0","imp-1","imp-1"]
function xt(e,t){Ht?Fe(Ht,!1):function(e){Ht=e.children[0],n("Shield Imps Remaining: ",Ht),Bt=xe(),r(Ht,Bt),i(Ht,"&nbsp;")
const t=xe({className:"xSmallLink",textContent:"Recast"})
r(Ht,t),s(t,Nt)}(e)
const a=function(e){return e?Number(e.stack):0}(t)
Ht.className=function(e){return Gt[e]||"fshGreen"}(a),n(a,Bt)}function Tt(e,t,a){t||a?xt(e,t):Ht&&Fe(Ht,!0)}function Et(e){return 0===e.type}function jt(e){return xe({textContent:e})}let Pt,Ft,Ot,Rt,It,_t,qt,Yt,zt,Kt
function Ut(e,t){Pt?Fe(Pt,!1):function(e,t){Pt=e.children[5],n("Teleport Cooldown: ",Pt),Ft=jt(t.toString()),r(Pt,Ft)}(e,t)}function Wt(){const e=Math.max(Math.ceil((Ot-Date.now())/1e3),0)
n(e,Ft),e>0&&setTimeout(Wt,500)}function Qt(e,t){t?Ut(e,t):Pt&&Fe(Pt,!0)}function Jt(){Rt=Vt("Death Dealer"),It=Vt("Doubler"),_t=Vt("Counter Attack"),qt=Vt("Summon Shield Imp"),Yt=function(){const e=GameData.player().teleportCooldown
return e>1&&e}(),zt=function(){const{dynamic:e}=GameData.realm()
return l(e)&&e.some(Et)}(),Kt=GameData.player().killStreak}function Zt(){!function(){const e=$("#actionlist-shield-imp")
1===e.length&&e.css("background-color",St[e.text()]||"#ad8043")}(),Jt()
const e=bt([Rt,It,_t,qt,Yt,zt])
e&&(Tt(e,qt,Rt),Mt(e,Rt,zt,Kt),Ct(e,Rt,Kt),vt(e,_t),wt(e,It),Qt(e,Yt))}function Xt(e,t){var a
a=t.player.teleportCooldown,Ft&&(Ot=Date.now()+1e3*a,Wt())}const ea=["Breaker","Protection","Master Thief","Protect Gold","Disarm","Duelist","Thievery","Master Blacksmith","Master Crafter","Fury Caster","Master Inventor","Sustain"]
let ta,aa=[]
function na(e){54!==e.id&&26!==e.id||(ta.player.buffs[e.id]=parseInt(e.level,10))}function ra(e){-1===ea.indexOf(e.name)&&(ta.player.enhancements[e.name]=e.value)}function oa(e,t){ta={},ta.combat=t.response.data,ta.combat.inventory_id&&(ta.combat.drop=ta.combat.item.id),ta.player={},ta.player.buffs={},ta.player.enhancements={},function(e){e.player.buffs&&e.player.buffs.forEach(na)}(t),function(e){e.player.enhancements&&e.player.enhancements.forEach(ra)}(t),ta.time=t.time,aa.push(ta),He("fsh_combatLog",aa)}function ia(e,t){0===t.response.response&&oa(0,t)}function sa(e){e&&(aa=e),$.subscribe(p,ia)}function ua(t){return e.doNotKillList.includes(t.trim())}function la(e){e.classList.toggle("fshBlue",ua(b(e)))}function ca(){const e=a("actionList")
Pe("creature",e).forEach(la)}function fa(e){const t=GameData.actions()[e]
if(t)return function(e,t){if(ua(e))return a("actionList").children[t].children[0].children[1].classList.remove("loading"),!0}(t.data.name,e)}const da={2:function(e){return function(t,a,n,r){fa(n.passback)||e(t,a,n,r)}}}
function ma(e){return function(t,a,n,r){const o=da[t];(function(e){return e&&g(e)})(o)&&function(e){return v(e)||0===e}(r)?o(e)(t,a,n,r):e(t,a,n,r)}}function ha(e){e.remove()}function pa(e,t){!function(e){(function(e){return e.response&&e.response.msg&&e.response.msg.startsWith("Creature did not exist at that location")})(e)&&GameData.fetch(k+C)}(t),w(".creature-4 > .quickCombat > .verbs").forEach(ha)}function ba(){window.GameController&&GameController.Realm&&!GameController.Realm.footprintTileList&&(GameController.Realm.footprintTileList=[])}function ga(e,t,a){return Le({className:"fshCurveEle fshCurveLbl fshPoint tip-static "+e,dataset:{tipped:t},htmlFor:a})}function va(e){const a=t({className:"fshToggle"}),n=ye({checked:e.prefVal,id:e.checkId,type:"checkbox"})
r(a,n)
const o=ga(e.onClass,e.onTip,e.checkId)
r(a,o)
const i=ga(e.offClass,e.offTip,e.checkId)
return r(a,i),r(e.worldName,a),n}let ya,wa,ka,Ca,La,Da,Ma,Aa,Va
function Sa(e){return e?e.toString():"?"}function Ha(e){const a=t({className:"fshFsty"})
r(a,function(){const e=t({textContent:"Min Lvl: "})
return wa=jt(Sa(GameData.realm().minlevel)),r(e,wa),e}()),r(a,function(){const e=t({textContent:"Your Lvl: "})
return ka=jt(Sa(GameData.player().level)),r(e,ka),e}()),r(e,a)}function Ba(e,t,a){const n=Ge({className:"fshCurveEle fshCurveBtn fshPoint tip-static "+e,dataset:{tipped:t}})
return r(a,n),n}function $a(){var t
Ha(t=ya),Ca=Ba("fshFormGroup","Quick Create Attack Group",t),La=Ba("fshQuickBuff","Open Quick Buff Popup",t),Da=Ba("fshRealmMap","Open Realm Map",t),Ma=Ba("fshTempleOne","Search map in Ultimate FSG",t),function(e){if(h("showSpeakerOnWorld")){const t=h("playNewMessageSound")
Aa=va({prefVal:t,checkId:"fshSoundCheck",onClass:"soundOn",onTip:"Turn Off Sound when you have a new log message",offClass:"soundOff",offTip:"Turn On Sound when you have a new log message",worldName:e})}}(ya),function(t){const a=e.huntingMode
Va=va({prefVal:a,checkId:"fshHuntCheck",onClass:"huntOn",onTip:"Hunting mode is ON",offClass:"huntOff",offTip:"Hunting mode is OFF",worldName:t})}(ya)}const Na=[[e=>e===Aa,function(){m("playNewMessageSound",!h("playNewMessageSound"))}],[e=>e===Va,function(){e.huntingMode=!e.huntingMode,m("huntingMode",e.huntingMode)}]],Ga=[[e=>e===Ca,function(e){A(e),GameData.doAction(12,401,{},0)}],[e=>e===La,function(){Ve(ve())}],[e=>e===Da,function(){window.open(V+S+"map","fsMap")}],[e=>e===Ma,function(){const e=GameData.realm()
window.open(`${H}realms${S}view&realm_id=${e.id}`,"mapUfsg")}]]
function xa(){ya||(ya=t({className:"fshCurveContainer",id:"fshWorldButtonContainer"}),$a(),s(ya,Re(Ga)),M(ya,"change",Re(Na)),De(ya,a("worldCoord")))}function Ta(e,t){wa&&t.b.minlevel&&(ba(),n(t.b.minlevel,wa))}function Ea(e,t){ka&&n(t.b,ka)}function ja(e){return!e||!e.response||!e.response.data}let Pa,Fa,Oa,Ra,Ia,_a,qa,Ya,za,Ka,Ua,Wa,Qa,Ja,Za,Xa,en,tn,an,nn,rn,on,sn,un,ln,cn,fn,dn,mn,hn,pn,bn,gn,vn,yn
function wn(e){return e.player_name}function kn(e){!function(e){Ra=e.defenders.map(wn)}(e),Pa?B("",Pa):Pa=t({className:"body"}),function(e){Fa=t({className:"fshFloatLeft fshRelicLeftDiv"}),r(Pa,Fa),e.is_owner&&r(Fa,Qe(Ra)),Oa=Ge({className:"custombutton",textContent:"Fetch Stats"}),r(Fa,Oa)}(e)
const n=a("dialog-relic")
r(n,Pa)}const Cn=[e=>"lastUpdate"!==e,e=>!Ra.includes(e),e=>Ia[e].last_login,e=>Number(Ia[e].last_login)<_a,e=>Number(Ia[e].last_login)>qa,e=>Ia[e].level<400||Ia[e].level>421,e=>Ia[e].level<441||Ia[e].level>450]
function Ln(e,t){return t(e)}function Dn(e){return Cn.every(o(Ln,e))}function Mn(e){return`<a href="${G}${Ia[e].id}">${e}</a>`}function An(e){Ia=e,_a=x-120,qa=x-604800
const t=N(Ia).filter(Dn).map(Mn)
i(Pa,'<div class="fshFloatLeft fshRelicLowDiv"><table class="relicT"><thead><tr><th>'+t.length.toString()+" Offline guild members not at relic:</th></tr></thead>"+`<tbody><tr><td>${t.join(" ")}</td></tr></tbody></table></div>`)}function Vn(e){Te(Oa)
const n=h("hideRelicOffline")
e.is_owner&&!n&&We(!0).then(An),i(Fa,'<table class="relicT"><thead><tr><th colspan="2">Processing</th></tr></thead><tbody><tr><td class="fshGreen" colspan="2" id="ProcessingStatus">Parsing defending guild stats ...</td></tr></tbody><thead><tr><th colspan="2">Assumptions</th></tr></thead><tbody><tr><td colspan="2" class="fshGrey">Above calculations include Constitution, Fortitude, Nightmare Visage, Chi Strike, Sanctuary, Terrorize and Flinch bonus calculations (in that order) on both the defending group and attacking group.</td></tr></tbody></table>'),yn=a("ProcessingStatus")
const o=t({className:"fshFloatLeft fshRelicMidDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Defending Guild Stats</th></tr></thead><tbody><tr><td>Relic Count:</td><td id="relicCount">0</td></tr><tr><td>Lead Defender Bonus:</td><td id="LDPercentage">0</td></tr><tr><td>Lead Defender Cloaked:</td><td id="LDCloaked">No</td></tr></tbody><thead><tr><th colspan="2">Other Defender Stats</th></tr></thead><tbody><tr><td>Raw Attack:</td><td class="fshGrey" id="attackValue">0</td></tr><tr><td>Attack w/ buffs:</td><td id="attackValueBuffed">0</td></tr><tr><td>Raw Defense:</td><td class="fshGrey" id="defenseValue">0</td></tr><tr><td>Defense w/buffs:</td><td id="defenseValueBuffed">0</td></tr><tr><td>Raw Armor:</td><td class="fshGrey" id="armorValue">0</td></tr><tr><td>Armor w/ buffs:</td><td id="armorValueBuffed">0</td></tr><tr><td>Raw Damage:</td><td class="fshGrey" id="damageValue">0</td></tr><tr><td>Damage w/ buffs:</td><td id="damageValueBuffed">0</td></tr><tr><td>Raw HP:</td><td class="fshGrey" id="hpValue">0</td></tr><tr><td>HP w/ buffs:</td><td id="hpValueBuffed">0</td></tr><tr><td>Cloaked:</td><td id="defendersCloaked">0</td></tr><tr><td>Processed:</td><td id="defendersProcessed">0</td></tr></tbody></table>'})
r(Pa,o),Ya=a("relicCount"),za=a("LDPercentage"),Ka=a("LDCloaked"),Ua=a("attackValue"),Wa=a("attackValueBuffed"),Qa=a("defenseValue"),Ja=a("defenseValueBuffed"),Za=a("armorValue"),Xa=a("armorValueBuffed"),en=a("damageValue"),tn=a("damageValueBuffed"),an=a("hpValue"),nn=a("hpValueBuffed"),rn=a("defendersCloaked"),on=a("defendersProcessed")
const s=t({className:"fshFloatLeft fshRelicRightDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Adjusted defense values</th></tr></thead><tbody><tr><td>DC225:</td><td id="DC225">0</td></tr><tr><td>DC175:</td><td id="DC175">0</td></tr><tr><td colspan="2">&nbsp;</td></tr></tbody><thead><tr><th colspan="2">Attacking Group Stats</th></tr></thead><tbody><tr><td>Raw Group Attack:</td><td class="fshGrey" id="GroupAttack"></td></tr><tr><td>Group Attack w/ buffs:</td><td id="GroupAttackBuffed"></td></tr><tr><td>Raw Group Defense:</td><td class="fshGrey" id="GroupDefense"></td></tr><tr><td>Group Defense w/ buffs:</td><td id="GroupDefenseBuffed"></td></tr><tr><td>Raw Group Armor:</td><td class="fshGrey" id="GroupArmor"></td></tr><tr><td>Group Armor w/ buffs:</td><td id="GroupArmorBuffed"></td></tr><tr><td>Raw Group Damage:</td><td class="fshGrey" id="GroupDamage"></td></tr><tr><td>Group Damage w/ buffs:</td><td id="GroupDamageBuffed"></td></tr><tr><td>Raw Group HP:</td><td class="fshGrey" id="GroupHP"></td></tr><tr><td>Group HP w/ buffs:</td><td id="GroupHPBuffed"></td></tr></tbody></table>'})
r(Pa,s),sn=a("DC225"),un=a("DC175"),ln=a("GroupAttack"),cn=a("GroupAttackBuffed"),fn=a("GroupDefense"),dn=a("GroupDefenseBuffed"),mn=a("GroupArmor"),hn=a("GroupArmorBuffed"),pn=a("GroupDamage"),bn=a("GroupDamageBuffed"),gn=a("GroupHP"),vn=a("GroupHPBuffed")}let Sn
function Hn(e){const t=T(e),a=E('#pCC img[src*="/relics/"]',t).length
var r
n(a,Ya),Sn=1===(r=a)?1.5:be(1-r/10,2),n(String(100*Sn)+"%",za)}function Bn(e,t){return e>10*t||e<t?e:10*t}const $n=[["levelValue","level"],["attackValue","attack"],["attackBonus","bonus_attack"],["defenseValue","defense"],["defenseBonus","bonus_defense"],["armorValue","armor"],["armorBonus","bonus_armor"],["damageValue","damage"],["damageBonus","bonus_damage"],["hpValue","hp"],["hpBonus","bonus_hp"],["killStreakValue","killstreak"]]
function Nn(e,t,a){e[a[0]]=Number(t[a[1]])}const Gn=[["counterAttackLevel","Counter Attack"],["doublerLevel","Doubler"],["deathDealerLevel","Death Dealer"],["darkCurseLevel","Dark Curse"],["holyFlameLevel","Holy Flame"],["constitutionLevel","Constitution"],["sanctuaryLevel","Sanctuary"],["flinchLevel","Flinch"],["nightmareVisageLevel","Nightmare Visage"],["superEliteSlayerLevel","Super Elite Slayer"],["fortitudeLevel","Fortitude"],["chiStrikeLevel","Chi Strike"],["terrorizeLevel","Terrorize"],["barricadeLevel","Barricade"],["reignOfTerrorLevel","Reign Of Terror"],["anchoredLevel","Anchored"],["severeConditionLevel","Severe Condition"],["entrenchLevel","Entrench"],["cloakLevel","Cloak"]]
function xn(e,t,a){e[a[0]]=t[a[1]]||0}function Tn(e){const t=et(e._skills),a={}
return function(e,t){$n.forEach(o(Nn,e,t))}(a,e),function(e,t){Gn.forEach(o(xn,e,t))}(a,t),a.superEliteSlayerMultiplier=be(.002*a.superEliteSlayerLevel,2),pe(a.armorValue)&&function(e){e.attackValue=Bn(e.attackBonus,e.levelValue),e.defenseValue=Bn(e.defenseBonus,e.levelValue),e.armorValue=Bn(e.armorBonus,e.levelValue),e.damageValue=Bn(e.damageBonus,e.levelValue),e.hpValue=e.hpBonus}(a),a}let En,jn,Pn,Fn,On,Rn,In,_n,qn,Yn,zn,Kn,Un,Wn
function Qn(e){return Math.round(e*Sn)}function Jn(){Lt(En,Ua),Lt(Pn,Qa),Lt(Fn,Za),Lt(On,en),Lt(In,an),n(_n,rn),qn+=1,n(qn,on)}function Zn(e){const t=function(e){return Math.ceil(zn.attack*(.0025*j(e["Nightmare Visage"],0)))}(e)
zn.attack-=t,function(){const e=Math.ceil(zn.attack*Yn.flinchLevel*.001)
Lt(zn.attack-e,cn)}()
const a=function(e){return Math.ceil(zn.defense*(1+.001*j(e.Constitution,0)))}(e)
Lt(a+t,dn),function(e){Lt(zn.armor+Math.floor(zn.armor*j(e.Sanctuary,0)*.001),hn)}(e)
const n=function(e,t){return Math.ceil(t*j(e.Fortitude,0)*.001)}(e,a)
!function(e){Lt(zn.hp+e,vn)}(n),function(e,t){const a=Math.ceil((zn.hp+t)*j(e["Chi Strike"],0)*.001),n=Math.ceil(zn.damage*Yn.terrorizeLevel*.001)
Lt(zn.damage+a-n,bn)}(e,n)}function Xn(){n("Processing attacking group stats ... ",yn),Kn&&(zn.attack-=Kn.attack,zn.defense-=Kn.defense,zn.armor-=Kn.armor,zn.damage-=Kn.damage,zn.hp-=Kn.hp),Lt(zn.attack,ln),Lt(zn.defense,fn),Lt(zn.armor,mn),Lt(zn.damage,pn),Lt(zn.hp,gn)
const e=et(GameData.player().buffs)
Zn(e),function(e){const t=Math.ceil(jn*j(e.Flinch,0)*.001)
Lt(jn-t,Wa)}(e),function(e){const t=Math.ceil(Rn*j(e.Terrorize,0)*.001)
Lt(Rn-t,tn)}(e),n("Done.",yn)}function er(){n("Processing defending guild stats ... ",yn),En+=Qn(Yn.attackValue),Pn+=Qn(Yn.defenseValue),Fn+=Qn(Yn.armorValue),On+=Qn(Yn.damageValue),In+=Qn(Yn.hpValue),Jn()
const e=Math.ceil(En*(.0025*Yn.nightmareVisageLevel))
!function(e){jn=En-e,Lt(jn,Wa)}(e)
const t=Math.ceil(Pn*(1+.001*Yn.constitutionLevel))
!function(e,t){const a=t+e
Lt(a,Ja),Lt(Math.ceil(.55*a),sn),Lt(Math.ceil(.65*a),un)}(e,t),Lt(Fn+Math.floor(Fn*Yn.sanctuaryLevel*.001),Xa)
const a=In+function(e){return Math.ceil(e*Yn.fortitudeLevel*.001)}(t)
Lt(a,nn),function(e){Rn=On+Math.ceil(e*Yn.chiStrikeLevel*.001),Lt(Rn)}(a),0!==Yn.cloakLevel&&n("Yes",Ka),GameData.player().hasGroup&&zn?Xn():n("Done.",yn)}function tr(e){const t=Tn(e)
En+=Math.round(t.attackValue*P),Pn+=Math.round(t.defenseValue*P),Fn+=Math.round(t.armorValue*P),On+=Math.round(t.damageValue*P),In+=Math.round(t.hpValue*P),0!==t.cloakLevel&&(_n+=1),Jn()}function ar(e){Yn=Tn(e)}function nr(e){zn=e}function rr(e){Kn=e}function or(e){n(e.message,yn)}function ir(e){const t=T(e),a=I('#pCC a[href*="confirmDisband"]',t)
if(!a)return
const n=function(e){const t=e.previousElementSibling.href,a=[Je(t).then(nr)]
return function(e){return-1!==e.parentNode.parentNode.previousElementSibling.previousElementSibling.innerHTML.indexOf('"#000099"')}(e)&&a.push(Ze().then(rr)),a}(a)
return Oe(n)}function sr(e,t){return 0===t?qe(e).then(ar):qe(e).then(tr).catch(or)}function ur(){let e=[R({cmd:"guild",subcmd:"view",guild_id:Un.controlled_by.guild_id}).then(Hn)]
return GameData.player().hasGroup&&e.push(R({cmd:"guild",subcmd:"groups"}).then(ir)),e=e.concat(Ra.map(sr)),e}function lr(){Vn(Un),En=0,Pn=0,Fn=0,On=0,In=0,_n=0,qn=0
const e=ur()
Ke(e,er)}function cr(e,t){ja(t)||(Un=t.response.data,Un.defenders.length>0&&(kn(Un),O(Oa,"click",lr)))}function fr(e){$("#statbar-gold").css("background-color",e)}function dr(){$("#HelperSendTotal").html(Ce(h("currentGoldSentTotal"))),Number(GameData.player().gold)>Wn?fr("red"):fr("inherit")}function mr(){Wn=h("goldAmount"),$("#statbar-gold-tooltip-general").append(`<dt class="stat-gold-sendTo">Send To:</dt><dd id="HelperSendTo">${h("goldRecipient")}</dd><dt class="stat-gold-sendAmt">Amount:</dt><dd id="HelperSendAmt">${Ce(Wn)}</dd><dt class="stat-gold-sendTo">Send?</dt><dd><input id="HelperSendGold" value="Send!" class="custombutton" type="submit"><input type="hidden" id="xc" value=""</dd><dt class="stat-gold-sendTotal">Total Sent:</dt><dd id="HelperSendTotal">${Ce(h("currentGoldSentTotal"))}</dd>`),$("#HelperSendGold").on("click",Y),dr(),$.subscribe(z,dr)}function hr(e){return K({cache:!1,url:"fetchdata.php",data:U(e,{fshrnd:Ue()}),dataType:"json"})}const pr=[]
function br(e){return ja(e)||pr.push(e),e}function gr(e,t){return e===Number(t.response.data.id)}function vr(e,t){e(t)}function yr(e,t){const a=pr.find(o(gr,e))
return a?function(e){return new Promise(t=>{W(3,vr,[t,e])})}(a):hr({a:1,id:e,passback:t}).then(br)}let wr,kr,Cr,Lr,Dr,Mr
function Ar(e,t){return Ae(Q(t,e))}function Vr(){var e
wr=GameData.player().level,e=a("statbar-character-tooltip-stats"),Cr=Ar(e,te),kr=Ar(e,J),Dr=Ar(e,Z),Lr=Ar(e,X),Mr=Ar(e,ee)}function Sr(e){return`<tr><td colspan="2">${e.name}:</td><td colspan="2">${e.value}</td></tr>`}function Hr(e,t,a){return function(e){return`<table><tr><td><img src="${ae}creatures/${e.image_id}.png" height="200" width="200"></td><td rowspan="2"><table width="400"><tr><td class="header" colspan="4" class="fshCenter">Statistics</td></tr>`}(e)+function(e,t){return`<tr><td>Class:&nbsp;</td><td width="40%">${e.creature_class}</td><td>Level:&nbsp;</td><td width="40%">${e.level} (your level:<span class="${t}">${wr}</span>)</td></tr>`}(e,a)+function(e){return`<tr><td>Attack:&nbsp;</td><td width="40%">${e.attack} (your defense:<span class="fshYellow">${kr}</span>)</td><td>Defense:&nbsp;</td><td width="40%">${e.defense} (your attack:<span class="fshYellow">${Cr}</span>)</td></tr>`}(e)+function(e){return`<tr><td>Armor:&nbsp;</td><td width="40%">${e.armor} (your damage:<span class="fshYellow">${Lr}</span>)</td><td>Damage:&nbsp;</td><td width="40%">${e.damage} (your armor:<span class="fshYellow">${Dr}</span>)</td></tr>`}(e)+function(e,t){return`<tr><td>HP:&nbsp;</td><td width="40%">${e.hp} (your HP:<span class="fshYellow">${Mr}</span>)(1H: <span class="fshRed">${t}</span>)</td><td>Gold:&nbsp;</td><td width="40%">${e.gold}</td></tr>`}(e,t)+'<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Enhancements</td></tr>'+function(e){return 0===e.enhancements.length?'<tr><td colspan="4">[no enhancements]</td></tr>':e.enhancements.map(Sr).join("")}(e)+function(e){return`<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Description</td></tr><tr><td colspan="4">${e.description}</td></tr><tr><td colspan="4" height="5"></td></tr></table></td></tr><tr><td class="fshCenter"><b>${e.name}</b></td></tr></table>`}(e)}function Br(t){if(!ja(t))return function(t){const a=Math.ceil(t.hp*e.hpVariable+t.armor*e.generalVariable)
let n="fshYellow"
return Vr(),wr>t.level&&(n="fshRed"),Hr(t,a,n)}(t.response.data)}const $r=["verb","view","tip-static"]
function Nr(e,t){const a=Br(t)
e.set("content.text",a)}function Gr(e,t,a){return yr(GameData.actions()[e].data.id,e).then(o(Nr,a)),"Loading..."}function xr(e,t){re("NewMap","CreatureInfo")
const a=oe((n=t).parentNode.children).indexOf(n)
var n,r,i
e.classList.add("fshTip"),r=e,i=o(Gr,a),$(r).qtip({overwrite:!0,show:{event:"mouseover",ready:!0},style:{classes:"qtip-tipsy qtip-custom"},position:{my:"center right",at:"center left",effect:!1,viewport:$(window)},content:{text:i},hide:{effect:!1}})}function Tr(t){if(!e.showCreatureInfo)return
const{target:a}=t,n=a.parentNode.parentNode.parentNode;(function(e,t){return Ie($r,e)&&!ne("fshTip",e)&&ne("creature",t)})(a,n)&&xr(a,n)}function Er(){return ze({subcmd:"scouttower"})}function jr(e,t){const a=e.insertCell(-1)
return[a.colSpan]=t,t[2]&&(a.className="header"),r(a,t[1]),a}function Pr(e,t,a){const n=e.insertRow(-1)
return a&&(n.className="fshBlue"),function(e,t){t.forEach(o(jr,e))}(n,t),n}function Fr(e,t){Pr(e,t[0],t[1])}function Or(e,t){t.forEach(o(Fr,e))}let Rr,Ir,_r,qr,Yr,zr,Kr,Ur,Wr,Qr,Jr,Zr,Xr,eo,to,ao,no,ro,oo,io,so,uo,lo,co,fo,mo,ho,po
function bo(){Ir=jt("Current"),_r=jt("Kills"),qr=jt("Member"),Yr=jt("% of Total"),zr=jt("Status"),Kr=jt("Titan HP"),Ur=jt("Total"),Wr=jt("Your Guild")}function go(){for(;no.rows.length>7;)no.deleteRow(7)}function vo(){const e=xe()
return r(e,Qr),we(e,"/"),r(e,Jr),e}function yo(e){const t=xe()
return r(t,e),we(t,"%"),t}function wo(){oo=null,ro&&!ne("fshHide",ro)&&(Fe(ro,!0),n("",Qr),n("",Jr),n("",Zr),n("",Xr),n("",eo),B("",to),B("",ao),go())}function ko(e){return 0===e.type&&(oo=e.base_creature_id,!0)}function Co(){if(ro)Fe(ro,!1)
else{const e=a("actionContainer")
ro=t({className:"fshActionBox titanInfo"}),Qr=xe(),Jr=xe(),Zr=xe(),Xr=xe(),eo=xe(),to=xe(),ao=xe(),no=$e({className:"fshCenter"}),bo(),Or(no,[[[[2,Kr,!0],[4,Wr,!0]]],[[[2,vo()],[4,Zr]]],[[[2,Ir,!0],[4,yo(Xr)]],!0],[[[2,Ur,!0],[4,yo(eo)]],!0],[[[2,zr,!0],[4,to]],!0],[[[6,ao]]],[[[2,qr,!0],[2,_r,!0],[2,Yr,!0]]]]),r(ro,no),r(e,ro)}}function Lo(e){return e<=0?'<span class="fshGreen cooldown">No active cooldown</span>':`<span class="fshMaroon cooldown">Cooldown until: ${function(e){const t=new Date(se+1e3*e)
return`${Ne(t.getHours())}:${Ne(t.getMinutes())} ${Ne(t.getDate())}/${ie[t.getMonth()]}/${t.getFullYear()}`}(e)}</span>`}function Do(e){return ge(tt(e.max_hp-e.current_hp,e.kills),2)}function Mo(e){return ge(100*e.kills/e.max_hp,2)}function Ao(e){[[e.current_hp,Qr],[e.max_hp,Jr],[e.kills,Zr],[Do(e),Xr],[Mo(e),eo]].forEach(([e,t])=>{n(e,t)}),B(function(e){return at(e.kills,e.max_hp,e.current_hp)}(e),to),B(Lo(e.cooldown),ao)}function Vo(e,t){return[[[2,jt(t.player.name)],[2,jt(t.kills.toString())],[2,jt(ge(100*t.kills/e.kills,2)+"%")]]]}function So(e){return e.realm&&e.creature.base_id===oo&&e.realm===Rr}function Ho(e){const t=e.find(So)
t&&(Ao(t),function(e){if(go(),!e.contributors)return
const t=e.contributors.map(o(Vo,e))
Or(no,t)}(t))}function Bo(t){return e.showTitanInfo&&l(t)&&t.some(ko)}function $o(e,t){(function(e){return e.s&&l(e.r)})(t)&&(Ho(t.r),Bo(GameData.realm().dynamic)?io=window.setTimeout(e,3e4):wo())}function No(){Er().then(o($o,No))}function Go(e){io&&(window.clearTimeout(io),io=null),Bo(e)?(Co(),No()):wo()}function xo(e){var t
e.dynamic&&(t=e.name,Rr=t,Go(e.dynamic))}function To(e,t){(function(e){return e.realm&&e.realm.name})(t)&&xo(t.realm)}function Eo(e){const t=e.response.response,a=e.response.msg
let n
if(0!==t){const e=a.indexOf("<")
n=-1!==e?a.substring(0,e):a}else n=`You purchased ${e.response.data.name} for ${Ce(e.response.data.cost)} gold.`
i(ho,n+"<br>")}function jo(){GameData.doAction(14,3,{id:so.id,item_id:so.itemId},0),lo.close()}function Po(){const e=ke(fo.value)
if(!e)return
const t=[]
for(let a=1;a<e;a+=1)t.push(hr({a:14,d:0,id:so.id,item_id:so.itemId}).then(Eo))
Ke(t,jo)}function Fo(){co?n("",ho):(co=t({className:"fshClear",textContent:"Select how many to quick-buy:"}),fo=ye({id:"buyAmount",className:"fshNumberInput",min:1,max:99,value:1,type:"number"}),r(co,fo),mo=Ge({textContent:"Quick-buy"}),s(mo,Po),r(co,mo),ho=t(),r(co,ho),r(uo,co))}function Oo(e,t){so=t,uo=uo||a("shopDialogConfirm"),uo&&(lo=lo||$(uo).data("hcsWorldDialogShopConfirm"),lo&&Fo())}function Ro(e){po[e.name]?po[e.name].seen&&(po[e.name].seen+=1):(po[e.name]={seen:1},function(e,t){t.creature_class=e.creature_class,t.image_id=e.image_id,t.level=Number(e.level),t.type=e.type}(e,po[e.name]))}function Io(e,t,a){return t?e(t,a):a}function _o(e,t){const a=e||{}
return a.min=Io(Math.min,a.min,t),a.max=Io(Math.max,a.max,t),a}const qo=["attack","armor","damage","defense","hp"]
function Yo(e,t,a){const n=_o(t[a],Number(e[a]));(function(e,t){return!e||e.min!==t.min||e.max!==t.max})(t[a],n)&&(t[a]=n)}function zo(e,t){e[t.name]=_o(e[t.name],Number(t.value))}function Ko(e){po||(po={}),Ro(e),function(e,t){qo.forEach(o(Yo,e,t))}(e,po[e.name]),function(e,t){(function(e){return e.enhancements&&e.enhancements.length>0})(e)&&(t.enhancements=t.enhancements||{},e.enhancements.forEach(o(zo,t.enhancements)))}(e,po[e.name]),He("fsh_monsterLog",po)}function Uo(e){po=e||{}}const Wo=[]
function Qo(t){var a
ja(t)||(re("NewMap","MonsterLog"),a=t.response.data,e.showMonsterLog&&Ko(a))}function Jo(e,t){return e.id===t.id}function Zo(e,t){6!==e.type||function(e){if(Wo.find(o(Jo,e.data)))return!0
Wo.push(e.data)}(e)||yr(e.data.id,t).then(Qo)}function Xo(){e.showMonsterLog&&GameData.actions().forEach(Zo)}function ei(e){return ze(U({subcmd:"groups"},e))}function ti(e){return function(e){return ei({subcmd2:"viewstats",group_id:e})}(e)}function ai(){return ei({subcmd2:"view"})}function ni(e){return e.numberOfCreatureHitsTillDead-e.numberOfHitsRequired<=1?", dies on miss":", survives a miss"}const ri=[[e=>"-"===e.playerHits&&"-"===e.creatureHits,()=>"Unresolved"],[e=>"-"===e.playerHits,()=>"Player dies"],[e=>1===e.playerHits,e=>"Player 1 hits"+ni(e)],[e=>e.playerHits>1,e=>"Player > 1 hits"+ni(e)]]
function oi(e,t){return t[0](e)}function ii(e){e.playerHits=function(e){return"-"===e.numberOfCreatureHitsTillDead?e.numberOfHitsRequired:function(e){return"-"===e.numberOfHitsRequired||e.numberOfHitsRequired>e.numberOfCreatureHitsTillDead}(e)?"-":e.numberOfHitsRequired}(e),e.creatureHits=function(e){return"-"===e.numberOfHitsRequired?e.numberOfCreatureHitsTillDead:function(e){return"-"===e.numberOfCreatureHitsTillDead||e.numberOfCreatureHitsTillDead>e.numberOfHitsRequired}(e)?"-":e.numberOfCreatureHitsTillDead}(e),e.fightStatus=function(e){const t=ri.find(o(oi,e))
return t?t[1](e):"Unknown"}(e)}function si(e){e.creatureHitByHowMuch>=0?function(e){const t=e.generalVariable*e.creature.damage
t<e.overallArmorValue?e.numberOfCreatureHitsTillDead=e.overallHPValue:e.numberOfCreatureHitsTillDead=Math.ceil(e.overallHPValue/(t-e.overallArmorValue))}(e):e.numberOfCreatureHitsTillDead="-"}function ui(e){!function(e){const t=function(e){return e.callback.groupExists?e.callback.groupArmorValue:e.player.armorValue}(e)
e.overallArmorValue=t+Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}(e),function(e){e.player.sanctuaryLevel>0&&(e.extraNotes+=`Sanc Bonus Armor = ${Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}<br>`)}(e),function(e){e.terrorizeEffect=Math.floor(e.creature.damage*e.player.terrorizeLevel*.001)}(e),function(e){e.player.terrorizeLevel>0&&(e.extraNotes+=`Terrorize Creature Damage Effect = ${-1*e.terrorizeEffect}<br>`)}(e),e.creature.damage-=e.terrorizeEffect,function(e){e.creatureDamageDone=Math.ceil(e.generalVariable*e.creature.damage-e.overallArmorValue+e.overallHPValue)}(e),si(e)}function li(e){const t=function(e){return e.callback.groupExists?e.callback.groupAttackValue:e.player.attackValue}(e)
e.player.darkCurseLevel>0&&(e.extraNotes+=`DC Bonus Attack = ${Math.floor(e.creature.defense*e.player.darkCurseLevel*.002)}<br>`),e.nightmareVisageAttackMovedToDefense=Math.floor((t+e.counterAttackBonusAttack)*e.player.nightmareVisageLevel*.0025),e.player.nightmareVisageLevel>0&&(e.extraNotes+=`NMV Attack moved to Defense = ${e.nightmareVisageAttackMovedToDefense}<br>`),e.overallAttackValue=t+e.counterAttackBonusAttack-e.nightmareVisageAttackMovedToDefense,e.hitByHowMuch=function(e){const t=e.creature.defense-e.creature.defense*e.player.darkCurseLevel*.002
return 3===e.combatEvaluatorBias?e.overallAttackValue-Math.ceil(t)-50:e.overallAttackValue-Math.ceil(e.attackVariable*t)}(e)}function ci(e){e.lowestCALevelToStillHit=Math.max(Math.ceil((e.counterAttackBonusAttack-e.hitByHowMuch+1)/e.player.attackValue/.0025),0),e.lowestCALevelToStillKill=Math.max(Math.ceil((e.counterAttackBonusDamage-e.damageDone+1)/e.player.damageValue/.0025),0)}function fi(e){ci(e),e.lowestFeasibleCALevel=Math.max(e.lowestCALevelToStillHit,e.lowestCALevelToStillKill),e.extraNotes+=`Lowest CA to still 1-hit this creature = ${e.lowestFeasibleCALevel}<br>`,0!==e.lowestFeasibleCALevel&&function(e){e.extraAttackAtLowestFeasibleCALevel=Math.floor(.0025*e.player.attackValue*e.lowestFeasibleCALevel),e.extraDamageAtLowestFeasibleCALevel=Math.floor(.0025*e.player.damageValue*e.lowestFeasibleCALevel),e.extraNotes+=`Extra CA Att/Dam at this lowered CA level = ${e.extraAttackAtLowestFeasibleCALevel} / ${e.extraDamageAtLowestFeasibleCALevel}<br>`}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel=function(e){return e.player.counterAttackLevel>0?Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.lowestFeasibleCALevel):0}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel<e.extraStaminaPerHit?e.extraNotes+=`Extra Stam Used at this lowered CA level = ${e.extraStaminaPerHitAtLowestFeasibleCALevel}<br>`:e.extraNotes+="No reduction of stam used at the lower CA level<br>"}function di(e){(function(e){return e.player.counterAttackLevel>0&&1===e.numberOfHitsRequired})(e)&&fi(e),function(e){return"-"===e.numberOfHitsRequired||1!==e.numberOfHitsRequired}(e)&&function(e){ci(e),function(e){e.lowestCALevelToStillHit>175?e.extraNotes+="Even with CA175 you cannot hit this creature<br>":0!==e.lowestCALevelToStillHit&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillHit} to hit this creature<br>`)}(e),function(e){e.lowestCALevelToStillKill>175?e.extraNotes+="Even with CA175 you cannot 1-hit kill this creature<br>":0!==e.lowestCALevelToStillKill&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillKill} to 1-hit kill this creature<br>`)}(e)}(e)}function mi(e){!function(e){const t=function(e){return e.callback.groupExists?e.callback.groupHPValue:e.player.hpValue}(e),{fortitudeLevel:a}=e.player
e.fortitudeExtraHPs=Math.floor(t*a*.001),a>0&&(e.extraNotes+=`Fortitude Bonus HP = ${e.fortitudeExtraHPs}<br>`),e.overallHPValue=t+e.fortitudeExtraHPs}(e),function(e){const{chiStrikeLevel:t}=e.player
e.chiStrikeExtraDamage=Math.floor(e.overallHPValue*t*.001),t>0&&(e.extraNotes+=`Chi Strike Bonus Damage = ${e.chiStrikeExtraDamage}<br>`)}(e)
const t=function(e){return e.callback.groupExists?e.callback.groupDamageValue:e.player.damageValue}(e)
if(e.overallDamageValue=t+e.deathDealerBonusDamage+e.counterAttackBonusDamage+e.holyFlameBonusDamage+e.chiStrikeExtraDamage,e.damageDone=Math.floor(e.overallDamageValue-(e.generalVariable*e.creature.armor+e.hpVariable*e.creature.hp)),e.hitByHowMuch>0){let t=1
e.overallDamageValue>=e.generalVariable*e.creature.armor&&(t=e.overallDamageValue-e.generalVariable*e.creature.armor),e.numberOfHitsRequired=Math.ceil(e.hpVariable*e.creature.hp/t)}else e.numberOfHitsRequired="-"}function hi(e){return e.callback.groupExists?e.callback.groupDefenseValue:e.player.defenseValue}function pi(e){e.overallDefenseValue=hi(e)+Math.floor(hi(e)*e.player.constitutionLevel*.001)+e.nightmareVisageAttackMovedToDefense,function(e){e.player.constitutionLevel>0&&(e.extraNotes+=`Constitution Bonus Defense = ${Math.floor(hi(e)*e.player.constitutionLevel*.001)}<br>`)}(e),function(e){e.player.flinchLevel>0&&(e.extraNotes+=`Flinch Bonus Attack Reduction = ${Math.floor(e.creature.attack*e.player.flinchLevel*.001)}<br>`)}(e),e.creatureHitByHowMuch=Math.floor(e.attackVariable*e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue),3===e.combatEvaluatorBias&&(e.creatureHitByHowMuch=Math.floor(e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue-50))}function bi(e){e.extraNotes="",function(e){e.player.superEliteSlayerLevel>0&&(e.extraNotes+=`SES Stat Reduction Multiplier = ${e.player.superEliteSlayerMultiplier}<br>`)}(e),function(e){e.holyFlameBonusDamage=0,"Undead"===e.creature.class&&(e.holyFlameBonusDamage=Math.max(Math.floor((e.player.damageValue-e.creature.armor)*e.player.holyFlameLevel*.002),0),e.player.holyFlameLevel>0&&(e.extraNotes+=`HF Bonus Damage = ${e.holyFlameBonusDamage}<br>`))}(e),function(e){e.deathDealerBonusDamage=Math.floor(e.player.damageValue*(Math.min(.01*Math.floor(e.player.killStreakValue/5)*e.player.deathDealerLevel,20)/100))}(e),function(e){e.counterAttackBonusAttack=Math.floor(.0025*e.player.attackValue*e.player.counterAttackLevel),e.counterAttackBonusDamage=Math.floor(.0025*e.player.damageValue*e.player.counterAttackLevel)}(e),function(e){e.extraStaminaPerHit=0,e.player.counterAttackLevel>0&&(e.extraStaminaPerHit=Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.player.counterAttackLevel))}(e),function(e){e.player.deathDealerLevel>0&&(e.extraNotes+=`DD Bonus Damage = ${e.deathDealerBonusDamage}<br>`)}(e),function(e){e.player.counterAttackLevel>0&&(e.extraNotes+=`CA Bonus Attack/Damage = ${e.counterAttackBonusAttack} / ${e.counterAttackBonusDamage}<br>CA Extra Stam Used = ${e.extraStaminaPerHit}<br>`)}(e)}let gi,vi,yi,wi,ki,Ci,Li,Di,Mi,Ai
function Vi(){return ua(vi)?"Remove from do not kill list":"Add to the do not kill list"}function Si(){n(Vi(),yi)}function Hi(){const t=e.doNotKillList.indexOf(vi);-1===t?e.doNotKillList.push(vi):e.doNotKillList.splice(t,1),Si(),m("doNotKillList",e.doNotKillList.join()),ca()}function Bi(){yi?Si():function(){yi=Ge({className:"fshBl",textContent:Vi(),type:"button"})
const e=t({className:"description",innerHTML:'<span class="ui-helper-hidden-accessible"><input type="text"></span>'})
r(e,yi),r(gi,e),s(yi,Hi)}()}function $i(e,t){!function(e){if(!gi){const t=Q("body",e)
1===t.length&&([gi]=t)}}(t),gi&&(vi=e.trim(),Bi())}function Ni(){Ci||(ki||(ki=t(),r(wi,ki),r(wi,t({innerHTML:'<span class="fshFooter">*Does include CA, DD, HF, DC, Flinch, Super Elite Slayer, NMV, Sanctuary, Constitution, Fortitude, Chi Strike and Terrorize (if active) and allow for randomness (1.1053). Constitution, NMV, Fortitude and Chi Strike apply to group stats.</span>'}))),Ci=t(),r(ki,Ci))}function Gi(e){Ni(),B(e,Ci)}function xi(e){Li||(Ni(),Li=t(),r(ki,Li)),B(e,Li)}function Ti(e,t){const a={name:e.name,class:e.creature_class,attack:Number(e.attack),defense:Number(e.defense),armor:Number(e.armor),damage:Number(e.damage),hp:Number(e.hp)}
return function(e,t,a){3===a&&(t.attack-=Math.ceil(t.attack*e),t.defense-=Math.ceil(t.defense*e),t.armor-=Math.ceil(t.armor*e),t.damage-=Math.ceil(t.damage*e),t.hp-=Math.ceil(t.hp*e))}(t,a,e.type),a}function Ei(t,a,n){const r={}
r.callback=n,r.player=Tn(a),function(t){t.combatEvaluatorBias=e.combatEvaluatorBias,t.attackVariable=1.1053,t.generalVariable=e.generalVariable,t.hpVariable=e.hpVariable}(r),r.creature=Ti(t.response.data,r.player.superEliteSlayerMultiplier),function(e){bi(e),li(e),mi(e),pi(e),ui(e),ii(e),di(e)}(r),r.evaluatorHTML=function(e){return`<table width="100%"><tbody>${function(e){return`<tr><td bgcolor="#CD9E4B" colspan="4" align="center">${function(e){return e.callback.groupExists?"Group ":""}(e)}Combat Evaluation</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Will I hit it? </td><td align="left">${function(e){return e.hitByHowMuch>0?"Yes":"No"}(e)}</td><td align="right"><span style="color:#333333">Extra Attack: </td><td align="left">( ${e.hitByHowMuch} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333"># Hits to kill it? </td><td align="left">${e.numberOfHitsRequired}</td><td align="right"><span style="color:#333333">Extra Damage: </td><td align="left">( ${e.damageDone} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Will I be hit? </td><td align="left">${function(e){return e.creatureHitByHowMuch>=0?"Yes":"No"}(e)}</td><td align="right"><span style="color:#333333">Extra Defense: </td><td align="left">( ${-1*e.creatureHitByHowMuch} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333"># Hits to kill me? </td><td align="left">${e.numberOfCreatureHitsTillDead}</td><td align="right"><span style="color:#333333">Extra Armor + HP: </td><td align="left">( ${-1*e.creatureDamageDone} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333"># Player Hits? </td><td align="left">${e.playerHits}</td><td align="right"><span style="color:#333333"># Creature Hits? </td><td align="left">${e.creatureHits}</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Fight Status: </span></td><td align="left" colspan="3"><span>${e.fightStatus}</span></td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Notes: </span></td><td align="left" colspan="3"><span style="font-size:x-small;">${e.extraNotes}</span></td></tr>`}(e)}</tbody></table>`}(r),n.groupExists?xi(r.evaluatorHTML):Gi(r.evaluatorHTML)}function ji(e){return e.members[0].name===ve()}function Pi(e){if(l(e.r))return e.r.find(ji).id}function Fi(e,t,a){if(!a.r||!a.r.attributes)return
const n=a.r.attributes
Ei(e,t,{groupExists:!0,groupAttackValue:n[0].value,groupDefenseValue:n[1].value,groupArmorValue:n[2].value,groupDamageValue:n[3].value,groupHPValue:n[4].value})}function Oi(e,t,a){a&&ti(a).then(o(Fi,e,t))}function Ri(e,t){e.player.hasGroup&&function(e,t){ai().then(Pi).then(o(Oi,e,t))}(e,t),Ei(e,t,{groupExists:!1})}function Ii(e,t){wi||(wi=a("dialog-viewcreature")),wi&&(Gi(""),xi(""),function(e){return e.response&&e.response.data}(t)&&($i(t.response.data.name,wi),Ye(!0).then(o(Ri,t))))}function _i(){const t=[,[e.buffs,e.buffsName],[e.buffs2,e.buffs2Name],[e.buffs3,e.buffs3Name]][e.enabledHuntingMode]
l(t)&&([Di,Mi]=t)}function qi(t){"enabledHuntingMode"===t.target.name&&(e.enabledHuntingMode=t.target.value,m("enabledHuntingMode",e.enabledHuntingMode),_i(),GameData.fetch(u))}function Yi(e){const t=Q("verbs",e)
1===t.length&&Te(t[0])}function zi(){if(!Ai)return
const e=a("actionList")
Pe("player",e).forEach(Yi)}const Ki={hideSubLvlCreature:function(){e.hideSubLvlCreature=!e.hideSubLvlCreature,m("hideSubLvlCreature",e.hideSubLvlCreature),GameData.fetch(C)},hidePlayerActions:function(){Ai=!Ai,m("hidePlayerActions",Ai),GameData.fetch(C)},showCreatureInfo:function(){e.showCreatureInfo=!e.showCreatureInfo,m("showCreatureInfo",e.showCreatureInfo)},showHuntingBuffs:function(){e.showBuffs=!e.showBuffs,m("showHuntingBuffs",e.showBuffs),GameData.fetch(u)},showMonsterLog:function(){e.showMonsterLog=!e.showMonsterLog,m("showMonsterLog",e.showMonsterLog)},showTitanInfo:function(){e.showTitanInfo=!e.showTitanInfo,m("showTitanInfo",e.showTitanInfo),Go(GameData.realm().dynamic)},showBuffInfo:function(){e.showBuffInfo=!e.showBuffInfo,m("showBuffInfo",e.showBuffInfo),Zt()}}
function Ui(e){const t=Ki[e.target.name]
g(t)&&(e.target.blur(),t(e))}function Wi(){const e=t({className:"fshCenter fshFten"}),n=t({id:"fshWorldPrefs",innerHTML:`${Be("showCreatureInfo")}&nbsp;&nbsp;${Be("showMonsterLog")}&nbsp;&nbsp;${Be("showTitanInfo")}&nbsp;&nbsp;${Be("showBuffInfo")}<br>${Be("hideSubLvlCreature")}&nbsp;&nbsp;${Be("hidePlayerActions")}&nbsp;&nbsp;${ot()}`})
s(n,Ui),M(n,"change",qi),r(e,n)
const o=t()
r(e,o)
const i=a("worldContainerBelow").children[0]
return De(e,i),o}function Qi(e,t){return e[t.name]=!0,e}function Ji(e,t,a){return e[a.trim()]||t.push(a),t}function Zi(e){B("",e)}function Xi(e,t){const a=t.b.reduce(Qi,{}),n=Di.reduce(o(Ji,a),[])
n.length>0?function(e,t){B(`You are missing some ${Mi} hunting buffs<br>(${t.join(", ")})`,e)}(e,n):Zi(e)}function es(t,a,n){Di&&function(t,a,n){e.showBuffs?Xi(t,n):Zi(t)}(t,0,n)}const ts=[{generalVariable:1.1053,hpVariable:1.1},{generalVariable:1.1,hpVariable:1.053},{generalVariable:1.053,hpVariable:1},{generalVariable:1.1053,hpVariable:1}]
function as(){var t
e.combatEvaluatorBias=h("combatEvaluatorBias"),e.generalVariable=(t=e.combatEvaluatorBias,ts[t]?ts[t].generalVariable:1.1053),e.hpVariable=function(e){return ts[e]?ts[e].hpVariable:1.1}(e.combatEvaluatorBias)}function ns(e,t){return 6!==t.type||(0!==t.data.creature_type||t.data.level>=e)}function rs(e){const t=de(e)
return function(e){return!e||!e.actions||0===e.actions.length}(t)?e:(t.actions=t.actions.filter(o(ns,function(e){return e.realm&&e.realm.minlevel||GameData.realm().minlevel}(t))),JSON.stringify(t))}function os(t,a){e.hideSubLvlCreature&&function(e){return e.data&&e.data.d&&Xe(e.data.d,C)}(a)&&(t.dataFilter=rs)}function is(t){e[t[0]]=je(t[1])}function ss(t){e[t]=je(t)}function us(){[["buffs","huntingBuffs"],["buffs2","huntingBuffs2"],["buffs3","huntingBuffs3"]].forEach(is),["doNotKillList"].forEach(ss)}function ls(t){e[t[0]]=h(t[1])}function cs(t){e[t]=h(t)}function fs(){[["buffsName","huntingBuffsName"],["buffs2Name","huntingBuffs2Name"],["buffs3Name","huntingBuffs3Name"],["showBuffs","showHuntingBuffs"]].forEach(ls),["enabledHuntingMode","hideSubLvlCreature","showTitanInfo","showBuffInfo","showMonsterLog","showCreatureInfo"].forEach(cs)}function ds(e){$(`#actionList li.creature-${e.toString()} a.create-group`).hide()}const ms=["hideChampionsGroup","hideElitesGroup","hideSEGroup","hideTitanGroup","hideLegendaryGroup"]
function hs(e,t){var a
h(e)&&(a=t+1,$.subscribe(y,o(ds,a)),ds(t+1))}function ps(e,t){"ACT_REPAIR"===t&&GameData.fetch(he+u+k+C)}function bs(e){A(e.target)}const gs=[function(){as(),us(),fs()
const t=Wi()
$.ajaxPrefilter("JSON",os),e.hideSubLvlCreature&&GameData.fetch(C),function(t){_i()
const a=o(es,t)
$.subscribe(c,a),e.showBuffs&&window.initialGameData&&a(null,{b:window.initialGameData.player.buffs})}(t),Ai=h("hidePlayerActions"),$.subscribe(y,zi),zi()},function(){_(),q&&mr()},function(){$.subscribe(fe,Ii)},function(){ms.forEach(hs)},function(){h("enableCreatureColoring")&&r(document.body,Me("#actionList .creature-1 {color: green;}\n#actionList .creature-2 {color: yellow;}\n#actionList .creature-3 {color: red;}"))},function(){$.subscribe(y,ca),ca(),function(){const e=GameData.doAction
GameData.doAction=ma(e)}()},function(){Se("fsh_monsterLog").then(Uo),$.subscribe("-1-success.action-response 4-success.action-response 5-success.action-response 25-success.action-response",Xo),Xo()},function(){$.subscribe(me,ps)},function(){h("keepLogs")&&Se("fsh_combatLog").then(sa)},function(){window.initialGameData&&To(0,window.initialGameData),$.subscribe(`${ue} ${le}`,To)},function(){$.subscribe(ce,Oo)},function(){$.subscribe(F,cr)},function(){$("#messageCenter").worldMessageCenter({offset:"0 60"})},function(){A("#mapTooltip")},function(){xa(),$.subscribe(L,Ta),$.subscribe(D,Ea)},function(){Zt(),$.subscribe(`${c} ${f}`,Zt),$.subscribe(d,Xt)},function(){s(a("buffList"),bs)},function(){M(a("actionList"),"mouseover",Tr)}]
function vs(){Ee(gs),$.subscribe(p,pa)}export default vs
//# sourceMappingURL=newMap-6dac003a.js.map
